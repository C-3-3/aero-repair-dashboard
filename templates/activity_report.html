{% extends "base.html" %}
{% block title %}Task Activity Report{% endblock %}

{% block content %}
<h2>📊 Recent Task Activity</h2>

<form method="get" style="margin-bottom: 1rem;">
  <label>Date From: <input type="date" name="start_date"></label>
  <label>Date To: <input type="date" name="end_date"></label>

  <label>Status:
    <select name="status">
      <option value="">-- All --</option>
      <option value="Open">Open</option>
      <option value="In Progress">In Progress</option>
      <option value="Done">Done</option>
    </select>
  </label>

  <label>Aircraft: <input type="text" name="aircraft" placeholder="e.g. N12345"></label>

  <button type="submit">🔍 Filter</button>
</form>


<table border="1" cellpadding="8">
  <thead>
    <tr>
        <th>Aircraft</th>
        <th>Technician</th>
      <th>Work Order</th>
      <th>Task</th>
      <th>Status</th>
      <th>Comment</th>
      <th>Timestamp</th>
    </tr>
  </thead>
  <tbody>
    {% for row in updates %}
    <tr>
  <td>{{ row[0] }}</td> <!-- Work Order ID -->
  <td>
    <a href="{{ url_for('task_detail', wo_id=row[0], task_id=row[1]) }}">
      {{ row[1] }}
    </a> <!-- Task ID with link -->
  </td>
  <td>{{ wo_to_aircraft.get(row[0], "Unknown") }}</td> <!-- Aircraft -->
  <td>{{ row[2] }}</td> <!-- Status -->
  <td>{{ row[3] or "—" }}</td> <!-- Comment -->
  <td>{{ row[4] }}</td> <!-- User/Technician -->
  <td>{{ row[5] }}</td> <!-- Timestamp -->
</tr>



    {% endfor %}
  </tbody>
</table>

<a href="{{ url_for('dashboard') }}">← Back to Dashboard</a>
{% endblock %}
